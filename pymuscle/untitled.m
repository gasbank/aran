

a = sym('-KSE*(-1/sqrt(pow(-fibx+px+fibbx*(qw*qw)+fibbx*(qx*qx)-fibbx*(qy*qy)-fibbx*(qz*qz)+fibbz*qw*qy*2.0-fibby*qw*qz*2.0+fibby*qx*qy*2.0+fibbz*qx*qz*2.0,2.0)+pow(-fiby+py+fibby*(qw*qw)-fibby*(qx*qx)+fibby*(qy*qy)-fibby*(qz*qz)-fibbz*qw*qx*2.0+fibbx*qw*qz*2.0+fibbx*qx*qy*2.0+fibbz*qy*qz*2.0,2.0)+pow(-fibz+pz+fibbz*(qw*qw)-fibbz*(qx*qx)-fibbz*(qy*qy)+fibbz*(qz*qz)+fibby*qw*qx*2.0-fibbx*qw*qy*2.0+fibbx*qx*qz*2.0+fibby*qy*qz*2.0,2.0))*(vx+fibbz*qdy*(qw*qw*qw)*2.0-fibby*qdz*(qw*qw*qw)*2.0+fibby*qdy*(qx*qx*qx)*2.0+fibbz*qdz*(qx*qx*qx)*2.0+fibbz*qdw*(qy*qy*qy)*2.0+fibby*qdx*(qy*qy*qy)*2.0-fibby*qdw*(qz*qz*qz)*2.0+fibbz*qdx*(qz*qz*qz)*2.0+fibby*qdy*(qw*qw)*qx*2.0+fibbz*qdy*qw*(qx*qx)*2.0-fibby*qdz*qw*(qx*qx)*2.0+fibbz*qdz*(qw*qw)*qx*2.0+fibbx*qdw*qw*(qy*qy)*4.0-fibbz*qdw*(qw*qw)*qy*2.0+fibby*qdx*(qw*qw)*qy*2.0-fibbx*qdy*(qw*qw)*qy*4.0-fibbz*qdy*qw*(qy*qy)*2.0-fibby*qdz*qw*(qy*qy)*2.0+fibbx*qdw*qw*(qz*qz)*4.0+fibby*qdw*(qw*qw)*qz*2.0+fibbz*qdw*(qx*qx)*qy*2.0+fibbx*qdx*qx*(qy*qy)*4.0-fibby*qdx*(qx*qx)*qy*2.0+fibbz*qdx*(qw*qw)*qz*2.0-fibbx*qdy*(qx*qx)*qy*4.0-fibby*qdy*qx*(qy*qy)*2.0+fibbz*qdy*qw*(qz*qz)*2.0-fibbx*qdz*(qw*qw)*qz*4.0+fibby*qdz*qw*(qz*qz)*2.0+fibbz*qdz*qx*(qy*qy)*2.0-fibby*qdw*(qx*qx)*qz*2.0+fibbx*qdx*qx*(qz*qz)*4.0-fibbz*qdx*(qx*qx)*qz*2.0+fibby*qdy*qx*(qz*qz)*2.0-fibbx*qdz*(qx*qx)*qz*4.0-fibbz*qdz*qx*(qz*qz)*2.0-fibby*qdw*(qy*qy)*qz*2.0+fibbz*qdw*qy*(qz*qz)*2.0+fibby*qdx*qy*(qz*qz)*2.0+fibbz*qdx*(qy*qy)*qz*2.0-fibby*qdw*qw*qx*qy*4.0-fibbz*qdx*qw*qx*qy*4.0-fibbz*qdw*qw*qx*qz*4.0+fibby*qdx*qw*qx*qz*4.0+fibby*qdy*qw*qy*qz*4.0-fibbz*qdz*qw*qy*qz*4.0-fibbz*qdy*qx*qy*qz*4.0-fibby*qdz*qx*qy*qz*4.0)+1/pow(pow(-fibx+px+fibbx*(qw*qw)+fibbx*(qx*qx)-fibbx*(qy*qy)-fibbx*(qz*qz)+fibbz*qw*qy*2.0-fibby*qw*qz*2.0+fibby*qx*qy*2.0+fibbz*qx*qz*2.0,2.0)+pow(-fiby+py+fibby*(qw*qw)-fibby*(qx*qx)+fibby*(qy*qy)-fibby*(qz*qz)-fibbz*qw*qx*2.0+fibbx*qw*qz*2.0+fibbx*qx*qy*2.0+fibbz*qy*qz*2.0,2.0)+pow(-fibz+pz+fibbz*(qw*qw)-fibbz*(qx*qx)-fibbz*(qy*qy)+fibbz*(qz*qz)+fibby*qw*qx*2.0-fibbx*qw*qy*2.0+fibbx*qx*qz*2.0+fibby*qy*qz*2.0,2.0),3.0/2.0)*(-fibx+px+fibbx*(qw*qw)+fibbx*(qx*qx)-fibbx*(qy*qy)-fibbx*(qz*qz)+fibbz*qw*qy*2.0-fibby*qw*qz*2.0+fibby*qx*qy*2.0+fibbz*qx*qz*2.0)*(fibx*(-2.0)+px*2.0+fibbx*(qw*qw)*2.0+fibbx*(qx*qx)*2.0-fibbx*(qy*qy)*2.0-fibbx*(qz*qz)*2.0+fibbz*qw*qy*4.0-fibby*qw*qz*4.0+fibby*qx*qy*4.0+fibbz*qx*qz*4.0)*(vx+fibbz*qdy*(qw*qw*qw)*2.0-fibby*qdz*(qw*qw*qw)*2.0+fibby*qdy*(qx*qx*qx)*2.0+fibbz*qdz*(qx*qx*qx)*2.0+fibbz*qdw*(qy*qy*qy)*2.0+fibby*qdx*(qy*qy*qy)*2.0-fibby*qdw*(qz*qz*qz)*2.0+fibbz*qdx*(qz*qz*qz)*2.0+fibby*qdy*(qw*qw)*qx*2.0+fibbz*qdy*qw*(qx*qx)*2.0-fibby*qdz*qw*(qx*qx)*2.0+fibbz*qdz*(qw*qw)*qx*2.0+fibbx*qdw*qw*(qy*qy)*4.0-fibbz*qdw*(qw*qw)*qy*2.0+fibby*qdx*(qw*qw)*qy*2.0-fibbx*qdy*(qw*qw)*qy*4.0-fibbz*qdy*qw*(qy*qy)*2.0-fibby*qdz*qw*(qy*qy)*2.0+fibbx*qdw*qw*(qz*qz)*4.0+fibby*qdw*(qw*qw)*qz*2.0+fibbz*qdw*(qx*qx)*qy*2.0+fibbx*qdx*qx*(qy*qy)*4.0-fibby*qdx*(qx*qx)*qy*2.0+fibbz*qdx*(qw*qw)*qz*2.0-fibbx*qdy*(qx*qx)*qy*4.0-fibby*qdy*qx*(qy*qy)*2.0+fibbz*qdy*qw*(qz*qz)*2.0-fibbx*qdz*(qw*qw)*qz*4.0+fibby*qdz*qw*(qz*qz)*2.0+fibbz*qdz*qx*(qy*qy)*2.0-fibby*qdw*(qx*qx)*qz*2.0+fibbx*qdx*qx*(qz*qz)*4.0-fibbz*qdx*(qx*qx)*qz*2.0+fibby*qdy*qx*(qz*qz)*2.0-fibbx*qdz*(qx*qx)*qz*4.0-fibbz*qdz*qx*(qz*qz)*2.0-fibby*qdw*(qy*qy)*qz*2.0+fibbz*qdw*qy*(qz*qz)*2.0+fibby*qdx*qy*(qz*qz)*2.0+fibbz*qdx*(qy*qy)*qz*2.0-fibby*qdw*qw*qx*qy*4.0-fibbz*qdx*qw*qx*qy*4.0-fibbz*qdw*qw*qx*qz*4.0+fibby*qdx*qw*qx*qz*4.0+fibby*qdy*qw*qy*qz*4.0-fibbz*qdz*qw*qy*qz*4.0-fibbz*qdy*qx*qy*qz*4.0-fibby*qdz*qx*qy*qz*4.0)*(1.0/2.0)+1/pow(pow(-fibx+px+fibbx*(qw*qw)+fibbx*(qx*qx)-fibbx*(qy*qy)-fibbx*(qz*qz)+fibbz*qw*qy*2.0-fibby*qw*qz*2.0+fibby*qx*qy*2.0+fibbz*qx*qz*2.0,2.0)+pow(-fiby+py+fibby*(qw*qw)-fibby*(qx*qx)+fibby*(qy*qy)-fibby*(qz*qz)-fibbz*qw*qx*2.0+fibbx*qw*qz*2.0+fibbx*qx*qy*2.0+fibbz*qy*qz*2.0,2.0)+pow(-fibz+pz+fibbz*(qw*qw)-fibbz*(qx*qx)-fibbz*(qy*qy)+fibbz*(qz*qz)+fibby*qw*qx*2.0-fibbx*qw*qy*2.0+fibbx*qx*qz*2.0+fibby*qy*qz*2.0,2.0),3.0/2.0)*(-fiby+py+fibby*(qw*qw)-fibby*(qx*qx)+fibby*(qy*qy)-fibby*(qz*qz)-fibbz*qw*qx*2.0+fibbx*qw*qz*2.0+fibbx*qx*qy*2.0+fibbz*qy*qz*2.0)*(fibx*(-2.0)+px*2.0+fibbx*(qw*qw)*2.0+fibbx*(qx*qx)*2.0-fibbx*(qy*qy)*2.0-fibbx*(qz*qz)*2.0+fibbz*qw*qy*4.0-fibby*qw*qz*4.0+fibby*qx*qy*4.0+fibbz*qx*qz*4.0)*(vy-fibbz*qdx*(qw*qw*qw)*2.0+fibbx*qdz*(qw*qw*qw)*2.0-fibbz*qdw*(qx*qx*qx)*2.0+fibbx*qdy*(qx*qx*qx)*2.0+fibbx*qdx*(qy*qy*qy)*2.0+fibbz*qdz*(qy*qy*qy)*2.0+fibbx*qdw*(qz*qz*qz)*2.0+fibbz*qdy*(qz*qz*qz)*2.0+fibby*qdw*qw*(qx*qx)*4.0+fibbz*qdw*(qw*qw)*qx*2.0-fibby*qdx*(qw*qw)*qx*4.0+fibbz*qdx*qw*(qx*qx)*2.0+fibbx*qdy*(qw*qw)*qx*2.0+fibbx*qdz*qw*(qx*qx)*2.0+fibbx*qdx*(qw*qw)*qy*2.0-fibbz*qdx*qw*(qy*qy)*2.0+fibbx*qdz*qw*(qy*qy)*2.0+fibbz*qdz*(qw*qw)*qy*2.0-fibbx*qdw*(qw*qw)*qz*2.0+fibby*qdw*qw*(qz*qz)*4.0-fibbz*qdw*qx*(qy*qy)*2.0-fibbx*qdx*(qx*qx)*qy*2.0-fibby*qdx*qx*(qy*qy)*4.0-fibbz*qdx*qw*(qz*qz)*2.0-fibbx*qdy*qx*(qy*qy)*2.0+fibby*qdy*(qx*qx)*qy*4.0+fibbz*qdy*(qw*qw)*qz*2.0-fibbx*qdz*qw*(qz*qz)*2.0-fibby*qdz*(qw*qw)*qz*4.0+fibbz*qdz*(qx*qx)*qy*2.0+fibbx*qdw*(qx*qx)*qz*2.0-fibbz*qdw*qx*(qz*qz)*2.0+fibbx*qdy*qx*(qz*qz)*2.0+fibbz*qdy*(qx*qx)*qz*2.0+fibbx*qdw*(qy*qy)*qz*2.0+fibbx*qdx*qy*(qz*qz)*2.0+fibby*qdy*qy*(qz*qz)*4.0-fibbz*qdy*(qy*qy)*qz*2.0-fibby*qdz*(qy*qy)*qz*4.0-fibbz*qdz*qy*(qz*qz)*2.0-fibbx*qdw*qw*qx*qy*4.0+fibbz*qdy*qw*qx*qy*4.0-fibbx*qdx*qw*qx*qz*4.0+fibbz*qdz*qw*qx*qz*4.0-fibbz*qdw*qw*qy*qz*4.0-fibbx*qdy*qw*qy*qz*4.0-fibbz*qdx*qx*qy*qz*4.0-fibbx*qdz*qx*qy*qz*4.0)*(1.0/2.0)+1/pow(pow(-fibx+px+fibbx*(qw*qw)+fibbx*(qx*qx)-fibbx*(qy*qy)-fibbx*(qz*qz)+fibbz*qw*qy*2.0-fibby*qw*qz*2.0+fibby*qx*qy*2.0+fibbz*qx*qz*2.0,2.0)+pow(-fiby+py+fibby*(qw*qw)-fibby*(qx*qx)+fibby*(qy*qy)-fibby*(qz*qz)-fibbz*qw*qx*2.0+fibbx*qw*qz*2.0+fibbx*qx*qy*2.0+fibbz*qy*qz*2.0,2.0)+pow(-fibz+pz+fibbz*(qw*qw)-fibbz*(qx*qx)-fibbz*(qy*qy)+fibbz*(qz*qz)+fibby*qw*qx*2.0-fibbx*qw*qy*2.0+fibbx*qx*qz*2.0+fibby*qy*qz*2.0,2.0),3.0/2.0)*(-fibz+pz+fibbz*(qw*qw)-fibbz*(qx*qx)-fibbz*(qy*qy)+fibbz*(qz*qz)+fibby*qw*qx*2.0-fibbx*qw*qy*2.0+fibbx*qx*qz*2.0+fibby*qy*qz*2.0)*(fibx*(-2.0)+px*2.0+fibbx*(qw*qw)*2.0+fibbx*(qx*qx)*2.0-fibbx*(qy*qy)*2.0-fibbx*(qz*qz)*2.0+fibbz*qw*qy*4.0-fibby*qw*qz*4.0+fibby*qx*qy*4.0+fibbz*qx*qz*4.0)*(vz+fibby*qdx*(qw*qw*qw)*2.0-fibbx*qdy*(qw*qw*qw)*2.0+fibby*qdw*(qx*qx*qx)*2.0+fibbx*qdz*(qx*qx*qx)*2.0-fibbx*qdw*(qy*qy*qy)*2.0+fibby*qdz*(qy*qy*qy)*2.0+fibbx*qdx*(qz*qz*qz)*2.0+fibby*qdy*(qz*qz*qz)*2.0-fibby*qdw*(qw*qw)*qx*2.0+fibbz*qdw*qw*(qx*qx)*4.0-fibby*qdx*qw*(qx*qx)*2.0-fibbz*qdx*(qw*qw)*qx*4.0-fibbx*qdy*qw*(qx*qx)*2.0+fibbx*qdz*(qw*qw)*qx*2.0+fibbx*qdw*(qw*qw)*qy*2.0+fibbz*qdw*qw*(qy*qy)*4.0+fibby*qdx*qw*(qy*qy)*2.0+fibbx*qdy*qw*(qy*qy)*2.0-fibbz*qdy*(qw*qw)*qy*4.0+fibby*qdz*(qw*qw)*qy*2.0-fibbx*qdw*(qx*qx)*qy*2.0+fibby*qdw*qx*(qy*qy)*2.0+fibbx*qdx*(qw*qw)*qz*2.0+fibby*qdx*qw*(qz*qz)*2.0-fibbx*qdy*qw*(qz*qz)*2.0+fibby*qdy*(qw*qw)*qz*2.0+fibbx*qdz*qx*(qy*qy)*2.0+fibby*qdz*(qx*qx)*qy*2.0+fibby*qdw*qx*(qz*qz)*2.0-fibbx*qdx*(qx*qx)*qz*2.0-fibbz*qdx*qx*(qz*qz)*4.0+fibby*qdy*(qx*qx)*qz*2.0-fibbx*qdz*qx*(qz*qz)*2.0+fibbz*qdz*(qx*qx)*qz*4.0-fibbx*qdw*qy*(qz*qz)*2.0+fibbx*qdx*(qy*qy)*qz*2.0-fibby*qdy*(qy*qy)*qz*2.0-fibbz*qdy*qy*(qz*qz)*4.0-fibby*qdz*qy*(qz*qz)*2.0+fibbz*qdz*(qy*qy)*qz*4.0+fibbx*qdx*qw*qx*qy*4.0-fibby*qdy*qw*qx*qy*4.0-fibbx*qdw*qw*qx*qz*4.0-fibby*qdz*qw*qx*qz*4.0-fibby*qdw*qw*qy*qz*4.0+fibbx*qdz*qw*qy*qz*4.0-fibby*qdx*qx*qy*qz*4.0-fibbx*qdy*qx*qy*qz*4.0)*(1.0/2.0))+(KPE*KSE*1/sqrt(pow(-fibx+px+fibbx*(qw*qw)+fibbx*(qx*qx)-fibbx*(qy*qy)-fibbx*(qz*qz)+fibbz*qw*qy*2.0-fibby*qw*qz*2.0+fibby*qx*qy*2.0+fibbz*qx*qz*2.0,2.0)+pow(-fiby+py+fibby*(qw*qw)-fibby*(qx*qx)+fibby*(qy*qy)-fibby*(qz*qz)-fibbz*qw*qx*2.0+fibbx*qw*qz*2.0+fibbx*qx*qy*2.0+fibbz*qy*qz*2.0,2.0)+pow(-fibz+pz+fibbz*(qw*qw)-fibbz*(qx*qx)-fibbz*(qy*qy)+fibbz*(qz*qz)+fibby*qw*qx*2.0-fibbx*qw*qy*2.0+fibbx*qx*qz*2.0+fibby*qy*qz*2.0,2.0))*(fibx*(-2.0)+px*2.0+fibbx*(qw*qw)*2.0+fibbx*(qx*qx)*2.0-fibbx*(qy*qy)*2.0-fibbx*(qz*qz)*2.0+fibbz*qw*qy*4.0-fibby*qw*qz*4.0+fibby*qx*qy*4.0+fibbz*qx*qz*4.0)*(1.0/2.0))/b')
simplify(a)

