#!/usr/bin/python
# -*- coding: utf-8 -*-
"""
Optimization-based rigid body simulator
2010 Geoyeob Kim

Sparse matrix testsuit
"""
from numpy import *
from math import pow, sin, cos
from scipy import sparse

dTend_idy_ki = zeros(14)
dTend_idy_ji = zeros(14)

s_ki = zeros(14)
s_ji = zeros(14)

KPE = 200.
KSE = 300.
xrest = 0.5
b = 0.1

px_ki, py_ki, pz_ki = 1.,0., 3.
quat_ki = array([-1.,2,3,4])
quat_ki /= linalg.norm(quat_ki)
qw_ki, qx_ki, qy_ki, qz_ki = quat_ki
vx_ki, vy_ki, vz_ki = 1., 0., 0.
qdw_ki, qdx_ki, qdy_ki, qdz_ki = 1., 2., 3., 4.
fibbx_ki, fibby_ki, fibbz_ki = 0.,1.,0.
Ixx_ki, Iyy_ki, Izz_ki = 1., 2., 3.
m_ki = 10.

px_ji, py_ji, pz_ji = 0.5, 0., 3.
quat_ji = array([1.,5,-3,-4])
quat_ji /= linalg.norm(quat_ji)
qw_ji, qx_ji, qy_ji, qz_ji = quat_ji
vx_ji, vy_ji, vz_ji = 5., 6., 7.
qdw_ji, qdx_ji, qdy_ji, qdz_ji = 1., 2., 3., 4.
fibbx_ji, fibby_ji, fibbz_ji = 1., 1., 1.
Ixx_ji, Iyy_ji, Izz_ji = 1., 2., 3.
m_ji = 10.

Ten_i = 100.


################################################
#      Variable: dTend_idy_ki
################################################
_x1 = pow(b,-1)
_x2 = -fibbx_ji*qy_ji+fibby_ji*qx_ji+fibbz_ji*qw_ji
_x3 = -fibbx_ki*qy_ki+fibby_ki*qx_ki+fibbz_ki*qw_ki
_x4 = fibbx_ji*qz_ji-fibbz_ji*qx_ji+fibby_ji*qw_ji
_x5 = -fibby_ji*qz_ji+fibbz_ji*qy_ji+fibbx_ji*qw_ji
_x6 = fibbz_ji*qz_ji+fibby_ji*qy_ji+fibbx_ji*qx_ji
_x7 = fibbx_ki*qz_ki-fibbz_ki*qx_ki+fibby_ki*qw_ki
_x8 = -fibby_ki*qz_ki+fibbz_ki*qy_ki+fibbx_ki*qw_ki
_x9 = fibbz_ki*qz_ki+fibby_ki*qy_ki+fibbx_ki*qx_ki
_x10 = -qy_ki*_x9-qz_ki*_x8-qw_ki*_x7+qy_ji*_x6+qz_ji*_x5+qw_ji*_x4+qx_ki*_x3-qx_ji*_x2
_x11 = -qx_ki*_x9-qw_ki*_x8+qz_ki*_x7+qx_ji*_x6+qw_ji*_x5-qz_ji*_x4-qy_ki*_x3+qy_ji*_x2
_x12 = -qz_ki*_x9+qy_ki*_x8-qx_ki*_x7+qz_ji*_x6-qy_ji*_x5+qx_ji*_x4-qw_ki*_x3+qw_ji*_x2
_x13 = pow(pow(_x12,2)+pow(_x11,2)+pow(_x10,2),1/2)
_x14 = pow(_x13,-1)
_x15 = 2*fibbz_ki*qdy_ki
_x16 = -2*fibby_ki*qdz_ki
_x17 = _x16+_x15
_x18 = -2*fibbx_ki*qdz_ki
_x19 = _x18+2*fibbz_ki*qdx_ki
_x20 = -2*fibby_ki*qdx_ki
_x21 = 2*fibbx_ki*qdy_ki
_x22 = _x21+_x20
_x23 = -_x22*qz_ki-_x19*qy_ki+_x17*qx_ki
_x24 = -qdw_ki*qz_ki+qdx_ki*qy_ki-qdy_ki*qx_ki+qdz_ki*qw_ki
_x25 = -2*fibby_ki*_x24
_x26 = -qdx_ki*qz_ki-qdw_ki*qy_ki+qdz_ki*qx_ki+qdy_ki*qw_ki
_x27 = 2*fibbz_ki*_x26
_x28 = _x27+_x25
_x29 = -qz_ki*_x28
_x30 = -2*fibbz_ki*qdx_ki
_x31 = 2*fibbx_ki*qdz_ki
_x32 = _x31+_x30
_x33 = _x27+_x25-_x32*qz_ki-_x22*qy_ki+_x17*qw_ki
_x34 = -2*fibbx_ki*_x26
_x35 = qdy_ki*qz_ki-qdz_ki*qy_ki-qdw_ki*qx_ki+qdx_ki*qw_ki
_x36 = 2*fibby_ki*_x35
_x37 = _x36+_x34
_x38 = qx_ki*_x37
_x39 = -2*fibbx_ki*qdy_ki
_x40 = _x39+2*fibby_ki*qdx_ki
_x41 = _x36+_x34-_x17*qy_ki-_x19*qx_ki+_x40*qw_ki
_x42 = 2*fibbx_ki*_x24
_x43 = -2*fibbz_ki*_x35
_x44 = _x43+_x42
_x45 = -qw_ki*_x44
_x46 = _x43+_x42+_x17*qz_ki-_x40*qx_ki+_x32*qw_ki
_x47 = -qw_ki*_x28
_x48 = 2*fibbx_ki*_x26
_x49 = -2*fibby_ki*_x35
_x50 = _x49+_x48
_x51 = qy_ki*_x50
_x52 = qz_ki*_x44
_x53 = qy_ki*_x28
_x54 = -qw_ki*_x37
_x55 = -2*fibbx_ki*_x24
_x56 = 2*fibbz_ki*_x35
_x57 = _x56+_x55
_x58 = qx_ki*_x57
_x59 = -2*fibbx_ki*qw_ki
_x60 = -2*fibbz_ki*qy_ki
_x61 = 2*fibby_ki*qz_ki
_x62 = _x61+_x60+_x59
_x63 = -2*fibby_ki*qw_ki
_x64 = 2*fibbz_ki*qx_ki
_x65 = -2*fibbx_ki*qz_ki
_x66 = _x65+_x64+_x63
_x67 = -2*fibbz_ki*qw_ki
_x68 = -2*fibby_ki*qx_ki
_x69 = 2*fibbx_ki*qy_ki
_x70 = _x69+_x68+_x67
_x71 = 2*_x70*_x12+2*_x66*_x10+2*_x62*_x11
_x72 = pow(_x13,-3)
_x73 = -qdw_ji*qz_ji+qdx_ji*qy_ji-qdy_ji*qx_ji+qdz_ji*qw_ji
_x74 = -qdx_ji*qz_ji-qdw_ji*qy_ji+qdz_ji*qx_ji+qdy_ji*qw_ji
_x75 = 2*fibbz_ji*_x74-2*fibby_ji*_x73
_x76 = qdy_ji*qz_ji-qdz_ji*qy_ji-qdw_ji*qx_ji+qdx_ji*qw_ji
_x77 = 2*fibby_ji*_x76-2*fibbx_ji*_x74
_x78 = 2*fibbx_ji*_x73-2*fibbz_ji*_x76
_x79 = qw_ji*_x78-qx_ji*_x77+qz_ji*_x75
_x80 = 2*fibbx_ji*_x74-2*fibby_ji*_x76
_x81 = -qz_ji*_x78-qy_ji*_x80+qw_ji*_x75
_x82 = 2*fibbz_ji*_x76-2*fibbx_ji*_x73
_x83 = -qx_ji*_x82+qw_ji*_x77-qy_ji*_x75
_x84 = -qy_ji*_x82-qz_ji*_x80+qx_ji*_x75
_x85 = qz_ki*_x28
_x86 = -qx_ki*_x37
_x87 = qw_ki*_x44
_x88 = _x87+_x86+_x85
_x89 = qw_ki*_x28
_x90 = -qy_ki*_x50
_x91 = -qz_ki*_x44
_x92 = _x91+_x90+_x89
_x93 = -qy_ki*_x28
_x94 = qw_ki*_x37
_x95 = -qx_ki*_x57
_x96 = _x95+_x94+_x93
_x97 = -qy_ki*_x57-qz_ki*_x50+qx_ki*_x28
_x98 = -vx_ki+vx_ji-qx_ki*_x97-qy_ki*_x96-qw_ki*_x92+qz_ki*_x88+qx_ji*_x84+qy_ji*_x83+qw_ji*_x81-qz_ji*_x79
_x99 = -vy_ki+vy_ji-qy_ki*_x97+qx_ki*_x96-qz_ki*_x92-qw_ki*_x88+qy_ji*_x84-qx_ji*_x83+qz_ji*_x81+qw_ji*_x79
_x100 = -vz_ki+vz_ji-qz_ki*_x97-qw_ki*_x96+qy_ki*_x92-qx_ki*_x88+qz_ji*_x84+qw_ji*_x83-qy_ji*_x81+qx_ji*_x79
_x101 = 2*fibby_ki*qdy_ki
_x102 = 2*fibbz_ki*qdz_ki
_x103 = _x102+_x101
_x104 = 2*fibby_ki*qdw_ki
_x105 = _x31+_x104
_x106 = _x39+2*fibbz_ki*qdw_ki
_x107 = -_x106*qz_ki-_x105*qy_ki+_x103*qw_ki
_x108 = -2*fibbz_ki*qdw_ki
_x109 = _x21+_x108
_x110 = _x27+_x25-_x105*qz_ki-_x109*qy_ki+_x103*qx_ki
_x111 = _x18-2*fibby_ki*qdw_ki
_x112 = _x49+_x48+_x103*qz_ki-_x111*qx_ki+_x106*qw_ki
_x113 = _x43+_x42-_x103*qy_ki-_x109*qx_ki+_x111*qw_ki
_x114 = -qx_ki*_x28
_x115 = qz_ki*_x50
_x116 = qy_ki*_x57
_x117 = -2*fibbx_ki*qx_ki
_x118 = -2*fibby_ki*qy_ki
_x119 = -2*fibbz_ki*qz_ki
_x120 = _x119+_x118+_x117
_x121 = 2*fibbz_ki*qw_ki
_x122 = 2*fibby_ki*qx_ki
_x123 = -2*fibbx_ki*qy_ki
_x124 = _x123+_x122+_x121
_x125 = 2*_x66*_x12+2*_x124*_x10+2*_x120*_x11
_x126 = 2*fibbx_ki*qdx_ki
_x127 = _x102+_x126
_x128 = 2*fibbx_ki*qdw_ki
_x129 = _x16+_x128
_x130 = _x20+_x108
_x131 = _x130*qz_ki-_x129*qx_ki+_x127*qw_ki
_x132 = -2*fibbx_ki*qdx_ki
_x133 = _x132-2*fibbz_ki*qdz_ki
_x134 = -2*fibbz_ki*_x26+2*fibby_ki*_x24-_x130*qy_ki-_x133*qx_ki+_x129*qw_ki
_x135 = -2*fibbx_ki*qdw_ki
_x136 = 2*fibby_ki*qdz_ki+_x135
_x137 = _x36+_x34-_x127*qz_ki-_x136*qy_ki+_x130*qw_ki
_x138 = _x43+_x42-_x136*qz_ki-_x133*qy_ki+_x130*qx_ki
_x139 = 2*fibbx_ki*qw_ki
_x140 = 2*fibbz_ki*qy_ki
_x141 = -2*fibby_ki*qz_ki
_x142 = _x141+_x140+_x139
_x143 = 2*_x142*_x12+2*_x120*_x10+2*_x70*_x11
_x144 = _x101+_x126
_x145 = _x15+_x128
_x146 = _x30+_x104
_x147 = -_x146*qy_ki-_x145*qx_ki+_x144*qw_ki
_x148 = _x135-2*fibbz_ki*qdy_ki
_x149 = _x27+_x25+_x146*qz_ki-_x144*qx_ki+_x148*qw_ki
_x150 = _x132-2*fibby_ki*qdy_ki
_x151 = _x36+_x34-_x150*qz_ki-_x145*qy_ki+_x146*qx_ki
_x152 = _x56+_x55-_x148*qz_ki-_x150*qy_ki+_x146*qw_ki
_x153 = 2*fibby_ki*qw_ki
_x154 = -2*fibbz_ki*qx_ki
_x155 = 2*fibbx_ki*qz_ki
_x156 = _x155+_x154+_x153
_x157 = 2*_x120*_x12+2*_x62*_x10+2*_x156*_x11
_x158 = _x123+_x122
_x159 = _x65+_x64
_x160 = _x61+_x60
_x161 = qw_ki*_x160-qz_ki*_x159-qy_ki*_x158
_x162 = _x155+_x154
_x163 = qx_ki*_x160-qy_ki*_x162-_x158*qz_ki
_x164 = _x69+_x68
_x165 = -qy_ki*_x160-qx_ki*_x162+qw_ki*_x164
_x166 = qz_ki*_x160+qw_ki*_x159-qx_ki*_x164
_x167 = _x69+_x67
_x168 = _x65+_x63
_x169 = _x119+_x118
_x170 = qw_ki*_x169-qy_ki*_x168-_x167*qz_ki
_x171 = _x123+_x121
_x172 = qx_ki*_x169-qz_ki*_x168-qy_ki*_x171
_x173 = _x155+_x153
_x174 = -qy_ki*_x169+qw_ki*_x173-qx_ki*_x171
_x175 = qz_ki*_x169-qx_ki*_x173+qw_ki*_x167
_x176 = _x122+_x121
_x177 = _x61+_x59
_x178 = _x119+_x117
_x179 = qw_ki*_x178-qx_ki*_x177+_x176*qz_ki
_x180 = _x141+_x139
_x181 = -qz_ki*_x178-qy_ki*_x180+qw_ki*_x176
_x182 = 2*fibbx_ki*qx_ki
_x183 = 2*fibbz_ki*qz_ki+_x182
_x184 = -qx_ki*_x183+qw_ki*_x177-_x176*qy_ki
_x185 = -qy_ki*_x183-qz_ki*_x180+qx_ki*_x176
_x186 = _x64+_x63
_x187 = _x118+_x117
_x188 = _x60+_x59
_x189 = -qx_ki*_x188+qw_ki*_x187-_x186*qy_ki
_x190 = _x140+_x139
_x191 = _x186*qz_ki+qw_ki*_x190-qx_ki*_x187
_x192 = 2*fibby_ki*qy_ki+_x182
_x193 = -_x192*qz_ki-qy_ki*_x188+qx_ki*_x186
_x194 = -_x190*qz_ki-qy_ki*_x192+qw_ki*_x186
dTend_idy_ki[  3] = _x1*(_x71*_x14*KPE/2+b*(_x70*_x14*_x100-_x12*_x71*_x72*_x100/2+_x66*_x14*_x99-_x10*_x71*_x72*_x99/2+_x62*_x14*_x98-_x11*_x71*_x72*_x98/2+_x12*_x14*(_x58-qx_ki*_x46-qw_ki*_x41+_x54+qy_ki*_x33+_x53-qz_ki*_x23)+_x11*_x14*(qz_ki*_x46+_x52-qy_ki*_x41+_x51-qw_ki*_x33+_x47-qx_ki*_x23)+_x10*_x14*(-qw_ki*_x46+_x45+qx_ki*_x41+_x38-qz_ki*_x33+_x29-qy_ki*_x23)))*KSE
dTend_idy_ki[  4] = _x1*(_x125*_x14*KPE/2+b*(_x66*_x14*_x100-_x12*_x125*_x72*_x100/2+_x124*_x14*_x99-_x10*_x125*_x72*_x99/2+_x120*_x14*_x98-_x11*_x125*_x72*_x98/2+_x11*_x14*(_x116-qy_ki*_x113+qz_ki*_x112+_x115-qx_ki*_x110+_x114-qw_ki*_x107)+_x10*_x14*(_x95+qx_ki*_x113+_x94-qw_ki*_x112-qy_ki*_x110+_x93-qz_ki*_x107)+_x12*_x14*(-qw_ki*_x113+_x45+_x38-qx_ki*_x112-qz_ki*_x110+_x29+qy_ki*_x107)))*KSE
dTend_idy_ki[  5] = _x1*(_x143*_x14*KPE/2+b*(_x142*_x14*_x100-_x12*_x143*_x72*_x100/2+_x120*_x14*_x99-_x10*_x143*_x72*_x99/2+_x70*_x14*_x98-_x11*_x143*_x72*_x98/2+_x10*_x14*(_x116-qy_ki*_x138-qz_ki*_x137+_x115+_x114+qx_ki*_x134-qw_ki*_x131)+_x11*_x14*(_x58-qx_ki*_x138-qw_ki*_x137+_x54+_x53-qy_ki*_x134+qz_ki*_x131)+_x12*_x14*(-qz_ki*_x138+_x91+qy_ki*_x137+_x90+_x89-qw_ki*_x134-qx_ki*_x131)))*KSE
dTend_idy_ki[  6] = _x1*(_x157*_x14*KPE/2+b*(_x120*_x14*_x100-_x12*_x157*_x72*_x100/2+_x62*_x14*_x99-_x10*_x157*_x72*_x99/2+_x156*_x14*_x98-_x11*_x157*_x72*_x98/2+_x10*_x14*(-qz_ki*_x152+_x52-qy_ki*_x151+_x51-qw_ki*_x149+_x47+qx_ki*_x147)+_x12*_x14*(qy_ki*_x152+_x116-qz_ki*_x151+_x115-qx_ki*_x149+_x114-qw_ki*_x147)+_x11*_x14*(-qw_ki*_x152+_x87-qx_ki*_x151+_x86+qz_ki*_x149+_x85-qy_ki*_x147)))*KSE
dTend_idy_ki[  7] = -_x11*_x14*KSE
dTend_idy_ki[  8] = -_x10*_x14*KSE
dTend_idy_ki[  9] = -_x12*_x14*KSE
dTend_idy_ki[ 10] = (_x11*(qz_ki*_x166-qy_ki*_x165-qx_ki*_x163-qw_ki*_x161)*_x14+_x12*(-qx_ki*_x166-qw_ki*_x165-qz_ki*_x163+qy_ki*_x161)*_x14+_x10*(-qw_ki*_x166+qx_ki*_x165-qy_ki*_x163-qz_ki*_x161)*_x14)*KSE
dTend_idy_ki[ 11] = (_x11*(qz_ki*_x175-qy_ki*_x174-qx_ki*_x172-qw_ki*_x170)*_x14+_x12*(-qx_ki*_x175-qw_ki*_x174-qz_ki*_x172+qy_ki*_x170)*_x14+_x10*(-qw_ki*_x175+qx_ki*_x174-qy_ki*_x172-qz_ki*_x170)*_x14)*KSE
dTend_idy_ki[ 12] = (_x12*_x14*(-qz_ki*_x185-qw_ki*_x184+qy_ki*_x181-qx_ki*_x179)+_x10*_x14*(-qy_ki*_x185+qx_ki*_x184-qz_ki*_x181-qw_ki*_x179)+_x11*_x14*(-qx_ki*_x185-qy_ki*_x184-qw_ki*_x181+qz_ki*_x179))*KSE
dTend_idy_ki[ 13] = (_x10*(-qz_ki*_x194-qy_ki*_x193-qw_ki*_x191+qx_ki*_x189)*_x14+_x12*(qy_ki*_x194-qz_ki*_x193-qx_ki*_x191-qw_ki*_x189)*_x14+_x11*(-qw_ki*_x194-qx_ki*_x193+qz_ki*_x191-qy_ki*_x189)*_x14)*KSE
################################################
#      Variable: dTend_idy_ji
################################################
_x1 = pow(b,-1)
_x2 = 2*fibbz_ji*qdy_ji
_x3 = -2*fibby_ji*qdz_ji
_x4 = _x3+_x2
_x5 = -2*fibbx_ji*qdz_ji
_x6 = _x5+2*fibbz_ji*qdx_ji
_x7 = -2*fibby_ji*qdx_ji
_x8 = 2*fibbx_ji*qdy_ji
_x9 = _x8+_x7
_x10 = -_x9*qz_ji-_x6*qy_ji+_x4*qx_ji
_x11 = -qdw_ji*qz_ji+qdx_ji*qy_ji-qdy_ji*qx_ji+qdz_ji*qw_ji
_x12 = -2*fibby_ji*_x11
_x13 = -qdx_ji*qz_ji-qdw_ji*qy_ji+qdz_ji*qx_ji+qdy_ji*qw_ji
_x14 = 2*fibbz_ji*_x13
_x15 = _x14+_x12
_x16 = qw_ji*_x15
_x17 = -2*fibbz_ji*qdx_ji
_x18 = 2*fibbx_ji*qdz_ji
_x19 = _x18+_x17
_x20 = _x14+_x12-_x19*qz_ji-_x9*qy_ji+_x4*qw_ji
_x21 = 2*fibbx_ji*_x13
_x22 = qdy_ji*qz_ji-qdz_ji*qy_ji-qdw_ji*qx_ji+qdx_ji*qw_ji
_x23 = -2*fibby_ji*_x22
_x24 = _x23+_x21
_x25 = -qy_ji*_x24
_x26 = -2*fibbx_ji*qdy_ji
_x27 = _x26+2*fibby_ji*qdx_ji
_x28 = -2*fibbx_ji*_x13
_x29 = 2*fibby_ji*_x22
_x30 = _x29+_x28-_x4*qy_ji-_x6*qx_ji+_x27*qw_ji
_x31 = 2*fibbx_ji*_x11
_x32 = -2*fibbz_ji*_x22
_x33 = _x32+_x31
_x34 = -qz_ji*_x33
_x35 = _x32+_x31+_x4*qz_ji-_x27*qx_ji+_x19*qw_ji
_x36 = -fibbx_ji*qy_ji+fibby_ji*qx_ji+fibbz_ji*qw_ji
_x37 = -fibbx_ki*qy_ki+fibby_ki*qx_ki+fibbz_ki*qw_ki
_x38 = fibbx_ji*qz_ji-fibbz_ji*qx_ji+fibby_ji*qw_ji
_x39 = -fibby_ji*qz_ji+fibbz_ji*qy_ji+fibbx_ji*qw_ji
_x40 = fibbz_ji*qz_ji+fibby_ji*qy_ji+fibbx_ji*qx_ji
_x41 = fibbx_ki*qz_ki-fibbz_ki*qx_ki+fibby_ki*qw_ki
_x42 = -fibby_ki*qz_ki+fibbz_ki*qy_ki+fibbx_ki*qw_ki
_x43 = fibbz_ki*qz_ki+fibby_ki*qy_ki+fibbx_ki*qx_ki
_x44 = -qx_ki*_x43-qw_ki*_x42+qz_ki*_x41+qx_ji*_x40+qw_ji*_x39-qz_ji*_x38-qy_ki*_x37+qy_ji*_x36
_x45 = -qy_ki*_x43-qz_ki*_x42-qw_ki*_x41+qy_ji*_x40+qz_ji*_x39+qw_ji*_x38+qx_ki*_x37-qx_ji*_x36
_x46 = -qz_ki*_x43+qy_ki*_x42-qx_ki*_x41+qz_ji*_x40-qy_ji*_x39+qx_ji*_x38-qw_ki*_x37+qw_ji*_x36
_x47 = pow(pow(_x46,2)+pow(_x45,2)+pow(_x44,2),1/2)
_x48 = pow(_x47,-1)
_x49 = qz_ji*_x15
_x50 = _x29+_x28
_x51 = -qx_ji*_x50
_x52 = qw_ji*_x33
_x53 = -qy_ji*_x15
_x54 = qw_ji*_x50
_x55 = -2*fibbx_ji*_x11
_x56 = 2*fibbz_ji*_x22
_x57 = _x56+_x55
_x58 = -qx_ji*_x57
_x59 = 2*fibbx_ji*qw_ji
_x60 = 2*fibbz_ji*qy_ji
_x61 = -2*fibby_ji*qz_ji
_x62 = _x61+_x60+_x59
_x63 = 2*fibby_ji*qw_ji
_x64 = -2*fibbz_ji*qx_ji
_x65 = 2*fibbx_ji*qz_ji
_x66 = _x65+_x64+_x63
_x67 = 2*fibbz_ji*qw_ji
_x68 = 2*fibby_ji*qx_ji
_x69 = -2*fibbx_ji*qy_ji
_x70 = _x69+_x68+_x67
_x71 = 2*_x70*_x46+2*_x66*_x45+2*_x62*_x44
_x72 = pow(_x47,-3)
_x73 = _x52+_x51+_x49
_x74 = _x34+_x25+_x16
_x75 = _x58+_x54+_x53
_x76 = qx_ji*_x15
_x77 = -qz_ji*_x24
_x78 = -qy_ji*_x57
_x79 = _x78+_x77+_x76
_x80 = -qdw_ki*qz_ki+qdx_ki*qy_ki-qdy_ki*qx_ki+qdz_ki*qw_ki
_x81 = -qdx_ki*qz_ki-qdw_ki*qy_ki+qdz_ki*qx_ki+qdy_ki*qw_ki
_x82 = 2*fibbz_ki*_x81-2*fibby_ki*_x80
_x83 = qdy_ki*qz_ki-qdz_ki*qy_ki-qdw_ki*qx_ki+qdx_ki*qw_ki
_x84 = 2*fibby_ki*_x83-2*fibbx_ki*_x81
_x85 = 2*fibbx_ki*_x80-2*fibbz_ki*_x83
_x86 = qw_ki*_x85-qx_ki*_x84+qz_ki*_x82
_x87 = 2*fibbx_ki*_x81-2*fibby_ki*_x83
_x88 = -qz_ki*_x85-qy_ki*_x87+qw_ki*_x82
_x89 = 2*fibbz_ki*_x83-2*fibbx_ki*_x80
_x90 = -qx_ki*_x89+qw_ki*_x84-qy_ki*_x82
_x91 = -qy_ki*_x89-qz_ki*_x87+qx_ki*_x82
_x92 = -vx_ki+vx_ji-qx_ki*_x91-qy_ki*_x90-qw_ki*_x88+qz_ki*_x86+qx_ji*_x79+qy_ji*_x75+qw_ji*_x74-qz_ji*_x73
_x93 = -vy_ki+vy_ji-qy_ki*_x91+qx_ki*_x90-qz_ki*_x88-qw_ki*_x86+qy_ji*_x79-qx_ji*_x75+qz_ji*_x74+qw_ji*_x73
_x94 = -vz_ki+vz_ji-qz_ki*_x91-qw_ki*_x90+qy_ki*_x88-qx_ki*_x86+qz_ji*_x79+qw_ji*_x75-qy_ji*_x74+qx_ji*_x73
_x95 = 2*fibby_ji*qdy_ji
_x96 = 2*fibbz_ji*qdz_ji
_x97 = _x96+_x95
_x98 = 2*fibby_ji*qdw_ji
_x99 = _x18+_x98
_x100 = _x26+2*fibbz_ji*qdw_ji
_x101 = -_x100*qz_ji-_x99*qy_ji+_x97*qw_ji
_x102 = -2*fibbz_ji*qdw_ji
_x103 = _x8+_x102
_x104 = _x14+_x12-_x99*qz_ji-_x103*qy_ji+_x97*qx_ji
_x105 = _x5-2*fibby_ji*qdw_ji
_x106 = _x23+_x21+_x97*qz_ji-_x105*qx_ji+_x100*qw_ji
_x107 = _x32+_x31-_x97*qy_ji-_x103*qx_ji+_x105*qw_ji
_x108 = 2*fibbx_ji*qx_ji
_x109 = 2*fibby_ji*qy_ji
_x110 = 2*fibbz_ji*qz_ji
_x111 = _x110+_x109+_x108
_x112 = -2*fibbz_ji*qw_ji
_x113 = -2*fibby_ji*qx_ji
_x114 = 2*fibbx_ji*qy_ji
_x115 = _x114+_x113+_x112
_x116 = 2*_x66*_x46+2*_x115*_x45+2*_x111*_x44
_x117 = 2*fibbx_ji*qdx_ji
_x118 = _x96+_x117
_x119 = 2*fibbx_ji*qdw_ji
_x120 = _x3+_x119
_x121 = _x7+_x102
_x122 = _x121*qz_ji-_x120*qx_ji+_x118*qw_ji
_x123 = -2*fibbx_ji*qdx_ji
_x124 = _x123-2*fibbz_ji*qdz_ji
_x125 = -2*fibbz_ji*_x13+2*fibby_ji*_x11-_x121*qy_ji-_x124*qx_ji+_x120*qw_ji
_x126 = -2*fibbx_ji*qdw_ji
_x127 = 2*fibby_ji*qdz_ji+_x126
_x128 = _x29+_x28-_x118*qz_ji-_x127*qy_ji+_x121*qw_ji
_x129 = _x32+_x31-_x127*qz_ji-_x124*qy_ji+_x121*qx_ji
_x130 = -2*fibbx_ji*qw_ji
_x131 = -2*fibbz_ji*qy_ji
_x132 = 2*fibby_ji*qz_ji
_x133 = _x132+_x131+_x130
_x134 = 2*_x133*_x46+2*_x111*_x45+2*_x70*_x44
_x135 = _x95+_x117
_x136 = _x2+_x119
_x137 = _x17+_x98
_x138 = -_x137*qy_ji-_x136*qx_ji+_x135*qw_ji
_x139 = _x126-2*fibbz_ji*qdy_ji
_x140 = _x14+_x12+_x137*qz_ji-_x135*qx_ji+_x139*qw_ji
_x141 = _x123-2*fibby_ji*qdy_ji
_x142 = _x29+_x28-_x141*qz_ji-_x136*qy_ji+_x137*qx_ji
_x143 = _x56+_x55-_x139*qz_ji-_x141*qy_ji+_x137*qw_ji
_x144 = -2*fibby_ji*qw_ji
_x145 = 2*fibbz_ji*qx_ji
_x146 = -2*fibbx_ji*qz_ji
_x147 = _x146+_x145+_x144
_x148 = 2*_x111*_x46+2*_x62*_x45+2*_x147*_x44
_x149 = _x69+_x68
_x150 = _x146+_x145
_x151 = _x132+_x131
_x152 = qw_ji*_x151-qz_ji*_x150-qy_ji*_x149
_x153 = _x65+_x64
_x154 = qx_ji*_x151-qy_ji*_x153-_x149*qz_ji
_x155 = _x114+_x113
_x156 = -qy_ji*_x151-qx_ji*_x153+qw_ji*_x155
_x157 = qz_ji*_x151+qw_ji*_x150-qx_ji*_x155
_x158 = _x114+_x112
_x159 = _x146+_x144
_x160 = -2*fibby_ji*qy_ji
_x161 = -2*fibbz_ji*qz_ji
_x162 = _x161+_x160
_x163 = qw_ji*_x162-qy_ji*_x159-_x158*qz_ji
_x164 = _x69+_x67
_x165 = qx_ji*_x162-qz_ji*_x159-qy_ji*_x164
_x166 = _x65+_x63
_x167 = -qy_ji*_x162+qw_ji*_x166-qx_ji*_x164
_x168 = qz_ji*_x162-qx_ji*_x166+qw_ji*_x158
_x169 = _x68+_x67
_x170 = _x132+_x130
_x171 = -2*fibbx_ji*qx_ji
_x172 = _x161+_x171
_x173 = qw_ji*_x172-qx_ji*_x170+_x169*qz_ji
_x174 = _x61+_x59
_x175 = -qz_ji*_x172-qy_ji*_x174+qw_ji*_x169
_x176 = _x110+_x108
_x177 = -qx_ji*_x176+qw_ji*_x170-_x169*qy_ji
_x178 = -qy_ji*_x176-qz_ji*_x174+qx_ji*_x169
_x179 = _x145+_x144
_x180 = _x160+_x171
_x181 = _x131+_x130
_x182 = -qx_ji*_x181+qw_ji*_x180-_x179*qy_ji
_x183 = _x60+_x59
_x184 = _x179*qz_ji+qw_ji*_x183-qx_ji*_x180
_x185 = _x109+_x108
_x186 = -_x185*qz_ji-qy_ji*_x181+qx_ji*_x179
_x187 = -_x183*qz_ji-qy_ji*_x185+qw_ji*_x179
dTend_idy_ji[  3] = _x1*(_x71*_x48*KPE/2+b*(_x70*_x48*_x94-_x46*_x71*_x72*_x94/2+_x66*_x48*_x93-_x45*_x71*_x72*_x93/2+_x62*_x48*_x92-_x44*_x71*_x72*_x92/2+(_x58+qx_ji*_x35+qw_ji*_x30+_x54-qy_ji*_x20+_x53+qz_ji*_x10)*_x46*_x48+(qw_ji*_x35+_x52-qx_ji*_x30+_x51+qz_ji*_x20+_x49+qy_ji*_x10)*_x45*_x48+(-qz_ji*_x35+_x34+qy_ji*_x30+_x25+qw_ji*_x20+_x16+qx_ji*_x10)*_x44*_x48))*KSE
dTend_idy_ji[  4] = _x1*(_x116*_x48*KPE/2+b*(_x66*_x48*_x94-_x46*_x116*_x72*_x94/2+_x115*_x48*_x93-_x45*_x116*_x72*_x93/2+_x111*_x48*_x92-_x44*_x116*_x72*_x92/2+(qw_ji*_x107+_x52+_x51+qx_ji*_x106+qz_ji*_x104+_x49-qy_ji*_x101)*_x46*_x48+(qx_ji*_x57-qx_ji*_x107-qw_ji*_x50+qw_ji*_x106+qy_ji*_x104+qy_ji*_x15+qz_ji*_x101)*_x45*_x48+(_x78+qy_ji*_x107-qz_ji*_x106+_x77+qx_ji*_x104+_x76+qw_ji*_x101)*_x44*_x48))*KSE
dTend_idy_ji[  5] = _x1*(_x134*_x48*KPE/2+b*(_x133*_x48*_x94-_x46*_x134*_x72*_x94/2+_x111*_x48*_x93-_x45*_x134*_x72*_x93/2+_x70*_x48*_x92-_x44*_x134*_x72*_x92/2+(qz_ji*_x129+qz_ji*_x33-qy_ji*_x128+qy_ji*_x24-qw_ji*_x15+qw_ji*_x125+qx_ji*_x122)*_x46*_x48+(_x78+qy_ji*_x129+qz_ji*_x128+_x77+_x76-qx_ji*_x125+qw_ji*_x122)*_x45*_x48+(_x58+qx_ji*_x129+qw_ji*_x128+_x54+_x53+qy_ji*_x125-qz_ji*_x122)*_x44*_x48))*KSE
dTend_idy_ji[  6] = _x1*(_x148*_x48*KPE/2+b*(_x111*_x48*_x94-_x46*_x148*_x72*_x94/2+_x62*_x48*_x93-_x45*_x148*_x72*_x93/2+_x147*_x48*_x92-_x44*_x148*_x72*_x92/2+(-qy_ji*_x143+_x78+qz_ji*_x142+_x77+qx_ji*_x140+_x76+qw_ji*_x138)*_x46*_x48+(qz_ji*_x143+_x34+qy_ji*_x142+_x25+qw_ji*_x140+_x16-qx_ji*_x138)*_x45*_x48+(qw_ji*_x143-qw_ji*_x33+qx_ji*_x142+qx_ji*_x50-qz_ji*_x140-qz_ji*_x15+qy_ji*_x138)*_x44*_x48))*KSE
dTend_idy_ji[  7] = _x44*_x48*KSE
dTend_idy_ji[  8] = _x45*_x48*KSE
dTend_idy_ji[  9] = _x46*_x48*KSE
dTend_idy_ji[ 10] = ((qx_ji*_x157+qw_ji*_x156+qz_ji*_x154-qy_ji*_x152)*_x46*_x48+(qw_ji*_x157-qx_ji*_x156+qy_ji*_x154+qz_ji*_x152)*_x45*_x48+(-qz_ji*_x157+qy_ji*_x156+qx_ji*_x154+qw_ji*_x152)*_x44*_x48)*KSE
dTend_idy_ji[ 11] = ((qx_ji*_x168+qw_ji*_x167+qz_ji*_x165-qy_ji*_x163)*_x46*_x48+(qw_ji*_x168-qx_ji*_x167+qy_ji*_x165+qz_ji*_x163)*_x45*_x48+(-qz_ji*_x168+qy_ji*_x167+qx_ji*_x165+qw_ji*_x163)*_x44*_x48)*KSE
dTend_idy_ji[ 12] = ((qz_ji*_x178+qw_ji*_x177-qy_ji*_x175+qx_ji*_x173)*_x46*_x48+(qy_ji*_x178-qx_ji*_x177+qz_ji*_x175+qw_ji*_x173)*_x45*_x48+(qx_ji*_x178+qy_ji*_x177+qw_ji*_x175-qz_ji*_x173)*_x44*_x48)*KSE
dTend_idy_ji[ 13] = ((-qy_ji*_x187+qz_ji*_x186+qx_ji*_x184+qw_ji*_x182)*_x46*_x48+(qz_ji*_x187+qy_ji*_x186+qw_ji*_x184-qx_ji*_x182)*_x45*_x48+(qw_ji*_x187+qx_ji*_x186-qz_ji*_x184+qy_ji*_x182)*_x44*_x48)*KSE
################################################
#      Variable: s_ki
################################################
_x1 = pow(m_ki,-1)
_x2 = -fibbx_ji*qy_ji+fibby_ji*qx_ji+fibbz_ji*qw_ji
_x3 = -fibbx_ki*qy_ki+fibby_ki*qx_ki+fibbz_ki*qw_ki
_x4 = fibbx_ji*qz_ji-fibbz_ji*qx_ji+fibby_ji*qw_ji
_x5 = -fibby_ji*qz_ji+fibbz_ji*qy_ji+fibbx_ji*qw_ji
_x6 = fibbz_ji*qz_ji+fibby_ji*qy_ji+fibbx_ji*qx_ji
_x7 = fibbx_ki*qz_ki-fibbz_ki*qx_ki+fibby_ki*qw_ki
_x8 = -fibby_ki*qz_ki+fibbz_ki*qy_ki+fibbx_ki*qw_ki
_x9 = fibbz_ki*qz_ki+fibby_ki*qy_ki+fibbx_ki*qx_ki
_x10 = -qx_ki*_x9-qw_ki*_x8+qz_ki*_x7+qx_ji*_x6+qw_ji*_x5-qz_ji*_x4-qy_ki*_x3+qy_ji*_x2-px_ki+px_ji
_x11 = -qy_ki*_x9-qz_ki*_x8-qw_ki*_x7+qy_ji*_x6+qz_ji*_x5+qw_ji*_x4+qx_ki*_x3-qx_ji*_x2-py_ki+py_ji
_x12 = -qz_ki*_x9+qy_ki*_x8-qx_ki*_x7+qz_ji*_x6-qy_ji*_x5+qx_ji*_x4-qw_ki*_x3+qw_ji*_x2-pz_ki+pz_ji
_x13 = pow(pow(_x12,2)+pow(_x11,2)+pow(_x10,2),-1/2)
_x14 = pow(Izz_ki,-1)
_x15 = qw_ki*_x12*_x13*Ten_i-qx_ki*_x11*_x13*Ten_i+qy_ki*_x10*_x13*Ten_i
_x16 = qx_ki*_x12*_x13*Ten_i+qw_ki*_x11*_x13*Ten_i-qz_ki*_x10*_x13*Ten_i
_x17 = -qy_ki*_x12*_x13*Ten_i+qz_ki*_x11*_x13*Ten_i+qw_ki*_x10*_x13*Ten_i
_x18 = -qz_ki*_x12*_x13*Ten_i-qy_ki*_x11*_x13*Ten_i-qx_ki*_x10*_x13*Ten_i
_x19 = -qx_ki*_x18+qw_ki*_x17+qz_ki*_x16-qy_ki*_x15
_x20 = -qy_ki*_x18-qz_ki*_x17+qw_ki*_x16+qx_ki*_x15
_x21 = fibbx_ki*_x20-fibby_ki*_x19
_x22 = pow(Iyy_ki,-1)
_x23 = -qz_ki*_x18+qy_ki*_x17-qx_ki*_x16+qw_ki*_x15
_x24 = fibbz_ki*_x19-fibbx_ki*_x23
_x25 = pow(Ixx_ki,-1)
_x26 = fibby_ki*_x23-fibbz_ki*_x20
s_ki[  7] = _x1*_x10*_x13*Ten_i
s_ki[  8] = _x1*_x11*_x13*Ten_i
s_ki[  9] = _x1*_x12*_x13*Ten_i
s_ki[ 10] = 0.5*(-_x25*qx_ki*_x26-_x22*qy_ki*_x24-_x14*qz_ki*_x21)
s_ki[ 11] = 0.5*(_x25*qw_ki*_x26-_x22*qz_ki*_x24+_x14*qy_ki*_x21)
s_ki[ 12] = 0.5*(_x25*qz_ki*_x26+_x22*qw_ki*_x24-_x14*qx_ki*_x21)
s_ki[ 13] = 0.5*(-_x25*qy_ki*_x26+_x22*qx_ki*_x24+_x14*qw_ki*_x21)
################################################
#      Variable: s_ji
################################################
_x1 = pow(m_ji,-1)
_x2 = -fibbx_ji*qy_ji+fibby_ji*qx_ji+fibbz_ji*qw_ji
_x3 = -fibbx_ki*qy_ki+fibby_ki*qx_ki+fibbz_ki*qw_ki
_x4 = fibbx_ji*qz_ji-fibbz_ji*qx_ji+fibby_ji*qw_ji
_x5 = -fibby_ji*qz_ji+fibbz_ji*qy_ji+fibbx_ji*qw_ji
_x6 = fibbz_ji*qz_ji+fibby_ji*qy_ji+fibbx_ji*qx_ji
_x7 = fibbx_ki*qz_ki-fibbz_ki*qx_ki+fibby_ki*qw_ki
_x8 = -fibby_ki*qz_ki+fibbz_ki*qy_ki+fibbx_ki*qw_ki
_x9 = fibbz_ki*qz_ki+fibby_ki*qy_ki+fibbx_ki*qx_ki
_x10 = -qx_ki*_x9-qw_ki*_x8+qz_ki*_x7+qx_ji*_x6+qw_ji*_x5-qz_ji*_x4-qy_ki*_x3+qy_ji*_x2-px_ki+px_ji
_x11 = -qy_ki*_x9-qz_ki*_x8-qw_ki*_x7+qy_ji*_x6+qz_ji*_x5+qw_ji*_x4+qx_ki*_x3-qx_ji*_x2-py_ki+py_ji
_x12 = -qz_ki*_x9+qy_ki*_x8-qx_ki*_x7+qz_ji*_x6-qy_ji*_x5+qx_ji*_x4-qw_ki*_x3+qw_ji*_x2-pz_ki+pz_ji
_x13 = pow(pow(_x12,2)+pow(_x11,2)+pow(_x10,2),-1/2)
_x14 = pow(Izz_ji,-1)
_x15 = -qw_ji*_x12*_x13*Ten_i+qx_ji*_x11*_x13*Ten_i-qy_ji*_x10*_x13*Ten_i
_x16 = -qx_ji*_x12*_x13*Ten_i-qw_ji*_x11*_x13*Ten_i+qz_ji*_x10*_x13*Ten_i
_x17 = qy_ji*_x12*_x13*Ten_i-qz_ji*_x11*_x13*Ten_i-qw_ji*_x10*_x13*Ten_i
_x18 = qz_ji*_x12*_x13*Ten_i+qy_ji*_x11*_x13*Ten_i+qx_ji*_x10*_x13*Ten_i
_x19 = -qx_ji*_x18+qw_ji*_x17+qz_ji*_x16-qy_ji*_x15
_x20 = -qy_ji*_x18-qz_ji*_x17+qw_ji*_x16+qx_ji*_x15
_x21 = fibbx_ji*_x20-fibby_ji*_x19
_x22 = pow(Iyy_ji,-1)
_x23 = -qz_ji*_x18+qy_ji*_x17-qx_ji*_x16+qw_ji*_x15
_x24 = fibbz_ji*_x19-fibbx_ji*_x23
_x25 = pow(Ixx_ji,-1)
_x26 = fibby_ji*_x23-fibbz_ji*_x20
s_ji[  7] = -_x1*_x10*_x13*Ten_i
s_ji[  8] = -_x1*_x11*_x13*Ten_i
s_ji[  9] = -_x1*_x12*_x13*Ten_i
s_ji[ 10] = 0.5*(-_x25*qx_ji*_x26-_x22*qy_ji*_x24-_x14*qz_ji*_x21)
s_ji[ 11] = 0.5*(_x25*qw_ji*_x26-_x22*qz_ji*_x24+_x14*qy_ji*_x21)
s_ji[ 12] = 0.5*(_x25*qz_ji*_x26+_x22*qw_ji*_x24-_x14*qx_ji*_x21)
s_ji[ 13] = 0.5*(-_x25*qy_ji*_x26+_x22*qx_ji*_x24+_x14*qw_ji*_x21)

print s_ki
print s_ji
print s_ki + s_ji
